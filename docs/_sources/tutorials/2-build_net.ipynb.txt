{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "ec93cc15",
   "metadata": {},
   "source": [
    "# Build your network\n",
    "\n",
    "Variational wavefunctions in Quantax are built on [Equinox](https://github.com/patrick-kidger/equinox).\n",
    "In this tutorial, we will introduce how to build your network on Equinox, and how to test the performance of your network in Quantax."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "52c1c7c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "import jax\n",
    "import jax.numpy as jnp\n",
    "import jax.random as jr\n",
    "import quantax as qtx\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "L = 8"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "503dc060",
   "metadata": {},
   "source": [
    "## Equinox quick start\n",
    "\n",
    "Equinox is a minimalist neural network library built directly on top of JAX. Unlike Flax and Haiku, which come with higher-level abstractions, Equinox emphasizes flexibility and transparency: everything is just PyTrees and functions, making it easy to integrate with raw JAX code. This means you donâ€™t fight against the framework when experimenting with unconventional architectures, physics-inspired models, or custom training loops.\n",
    "\n",
    "A customized Equinox network is usually like this."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "dd8c8496",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Linear(weight=f64[3,2], bias=f64[3])\n"
     ]
    }
   ],
   "source": [
    "import equinox as eqx\n",
    "\n",
    "class Linear(eqx.Module):\n",
    "    weight: jax.Array\n",
    "    bias: jax.Array\n",
    "\n",
    "    def __init__(self, in_size, out_size, key):\n",
    "        wkey, bkey = jr.split(key)\n",
    "        self.weight = jr.normal(wkey, (out_size, in_size))\n",
    "        self.bias = jr.normal(bkey, (out_size,))\n",
    "\n",
    "    def __call__(self, x):\n",
    "        return self.weight @ x + self.bias\n",
    "    \n",
    "key = jr.key(0)\n",
    "linear = Linear(2, 3, key)\n",
    "print(linear)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4f9368ed",
   "metadata": {},
   "source": [
    "`eqx.Module` has two important properties.\n",
    "\n",
    "1. It's a PyTree. In this example, `weight` and `bias` are leaves on this PyTree."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "1163466a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "weight: [[ 1.88002989 -0.48121497]\n",
      " [ 0.41545723  2.38184008]\n",
      " [-0.57536705 -0.37054353]]\n",
      "bias: [-1.4008841  1.432145   0.6248107]\n",
      "Flattened leaves: [Array([[ 1.88002989, -0.48121497],\n",
      "       [ 0.41545723,  2.38184008],\n",
      "       [-0.57536705, -0.37054353]], dtype=float64), Array([-1.4008841,  1.432145 ,  0.6248107], dtype=float64)]\n"
     ]
    }
   ],
   "source": [
    "print(\"weight:\", linear.weight)\n",
    "print(\"bias:\", linear.bias)\n",
    "\n",
    "vals, treedef = jax.tree.flatten(linear)\n",
    "print(\"Flattened leaves:\", vals)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f298ef4c",
   "metadata": {},
   "source": [
    "2. It's callable, since the `__call__` method is defined in this object."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "6037fbd3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "outputs: [-0.48328416  6.61128238 -0.69164342]\n",
      "jitted outputs: [-0.48328416  6.61128238 -0.69164342]\n",
      "jacobian: Linear(weight=f64[3,3,2], bias=f64[3,3])\n"
     ]
    }
   ],
   "source": [
    "inputs = jnp.array([1.0, 2.0])\n",
    "outputs = linear(inputs)\n",
    "\n",
    "jitted_fn = jax.jit(lambda linear, x: linear(x))  # linear is jittable as it's a PyTree\n",
    "jitted_outputs = jitted_fn(linear, inputs)\n",
    "jacobian = jax.jacrev(jitted_fn)(linear, inputs)\n",
    "\n",
    "print(\"outputs:\", outputs)\n",
    "print(\"jitted outputs:\", jitted_outputs)\n",
    "print(\"jacobian:\", jacobian)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1a0e188d",
   "metadata": {},
   "source": [
    "Apart from that, Equinox provides convenient filtered functions like `filter_jit` for PyTree. It's similar to `jax.jit` but available for PyTree with non-jittable leaves. See the code below for example. In Quantax, we use these filtered functions for better flexibility."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "633e7bd4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "`jax.jit` failed due to non-jittable string data type in the list.\n",
      "Summation:  10.0\n",
      "`jax.grad` failed due to non-jittable string data type in the list.\n",
      "Gradient:  [None, None, Array([1., 1.], dtype=float64), None, Array([1., 1.], dtype=float64)]\n"
     ]
    }
   ],
   "source": [
    "def summation(l):\n",
    "    return sum(jnp.sum(x) for x in l if isinstance(x, jax.Array))\n",
    "\n",
    "l = [1, 2.0, jnp.array([1.0, 2.0]), \"string\", jnp.array([3.0, 4.0])]\n",
    "\n",
    "try:\n",
    "    out = jax.jit(summation)(l)\n",
    "except TypeError as e:\n",
    "    print(\"`jax.jit` failed due to non-jittable string data type in the list.\")\n",
    "\n",
    "out = eqx.filter_jit(summation)(l)\n",
    "print(\"Summation: \", out)\n",
    "\n",
    "try:\n",
    "    g = jax.grad(summation)(l)\n",
    "except TypeError as e:\n",
    "    print(\"`jax.grad` failed due to non-jittable string data type in the list.\")\n",
    "\n",
    "g = eqx.filter_grad(summation)(l)\n",
    "print(\"Gradient: \", g)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bf06c9d4",
   "metadata": {},
   "source": [
    "## Build wavefunction\n",
    "\n",
    "Let's start by building the following variational wavefunction\n",
    "\n",
    "$$\n",
    "x^{(1)} = \\mathrm{ReLU}(W^{(1)} s + b^{(1)}) \\\\\n",
    "x^{(2)} = W^{(2)} x^{(1)} + b^{(2)} \\\\\n",
    "\\psi = \\sum \\exp(x^{(2)})\n",
    "$$\n",
    "where the network has an array input $s$ and a scalar output $\\psi$, and $W^{(1)}$, $b^{(1)}$, $W^{(2)}$, and $b^{(2)}$ are variational parameters."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "41f4d5f5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MyModel(\n",
      "  layer1=Linear(\n",
      "    weight=f64[16,8],\n",
      "    bias=f64[16],\n",
      "    in_features=8,\n",
      "    out_features=16,\n",
      "    use_bias=True\n",
      "  ),\n",
      "  layer2=Linear(\n",
      "    weight=f64[16,16],\n",
      "    bias=f64[16],\n",
      "    in_features=16,\n",
      "    out_features=16,\n",
      "    use_bias=True\n",
      "  )\n",
      ")\n"
     ]
    }
   ],
   "source": [
    "import equinox as eqx\n",
    "\n",
    "class MyModel(eqx.Module):\n",
    "    layer1: eqx.nn.Linear  # The PyTree leaves can be another Equinox module\n",
    "    layer2: eqx.nn.Linear\n",
    "\n",
    "    def __init__(self, in_size: int, width: int):\n",
    "        keys = qtx.get_subkeys(2)  # Convenient function in Quantax to provide keys\n",
    "        layer1 = eqx.nn.Linear(in_size, width, key=keys[0])\n",
    "        self.layer1 = qtx.nn.apply_he_normal(keys[0], layer1)  # He initialization\n",
    "        layer2 = eqx.nn.Linear(width, width, key=keys[1])\n",
    "        self.layer2 = qtx.nn.apply_lecun_normal(keys[1], layer2)  # LeCun initialization\n",
    "\n",
    "    def __call__(self, x):\n",
    "        x = jax.nn.relu(self.layer1(x))\n",
    "        x = self.layer2(x)\n",
    "        psi = jnp.sum(jnp.exp(x))\n",
    "        return psi\n",
    "\n",
    "model = MyModel(in_size=L, width=16)\n",
    "print(model)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f3f0ab65",
   "metadata": {},
   "source": [
    "We can test it by making a forward pass."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "36df2edf",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "psi = 25.80643431025371\n"
     ]
    }
   ],
   "source": [
    "s = jnp.ones(L)\n",
    "psi = model(s)\n",
    "print(\"psi =\", psi)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "80fb5455",
   "metadata": {},
   "source": [
    "Now let's use this new network in Quantax. One should wrap the network by `qtx.state.Variational` to use it as a variational state. It supports batched forward pass."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "2914ef8d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of parameters: 416\n",
      "psi = [32.53068691 27.79913187 15.22629544 19.97114671 34.05009489 15.61717887\n",
      " 22.10967177 21.51156317]\n"
     ]
    }
   ],
   "source": [
    "lattice = qtx.sites.Chain(L)\n",
    "state = qtx.state.Variational(model)\n",
    "\n",
    "print(\"Number of parameters:\", state.nparams)\n",
    "\n",
    "s = qtx.utils.rand_states(8)  # 8 random spin configurations\n",
    "psi = state(s)  # Batched forward pass\n",
    "print(\"psi =\", psi)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f7995f5d",
   "metadata": {},
   "source": [
    "## Test by exact reconfiguration\n",
    "\n",
    "Exact reconfiguration (ER) is an optimization method that approximates imaginary-time evolution without Monte Carlo samples, which is only available in small systems. We can use it to rapidly test the expressive power of neural networks."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "6e01ed7c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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33nnHU2ePFknTpxQVlaWJGnRokV64IEHdPr0aTmdzjO+1549ezR48GBt2rRJo0aNkiQtX75cN910k44dO6bc3Nx21cQQVffj9nj154+P6qlVB1RW2yhJ6psRp3uu668pw3PlsDPfHgA6u04xRHUu69ev19ChQwPhRpImTJigyspK7dq1q9VzkpOTA+FGksaNGyebzaYNGza0+lput1uVlZUtDnQvLoddd16drw/uv073jb9ISTFR+vx0jX786nbd8MT7+uumo3J72N8KACKFZQGnsLCwRbiRFPi6sLCw1XMyMzNbPOZwOJSamtrqOZI0f/58JSUlBY68vLwLrB5dVUJ0lP6/GwZo3QPX6f6JA5USG6UjJbV64P926Opfr9bC1QdV0dTDAwDoujoUcObNmyfDMNo89u7dG6paz9uDDz6oioqKwFFQUGB1SbBYQnSU7r62v9Y9cL1+etMgZSdG63SVW4+/u09jF6zUL9/apSMlNVaXCQA4T46ONL7vvvs0c+bMNtv07du3Xd8rOztbGzdubPFYUVFR4LnWzjl16lSLxzwej0pLS1s9R5JcLpdcLle76kL3Eudy6K6v9tPMK/O17NMTeu6Dz7W3sEovfHhYL350WNdclKEZY/vomosyZLMZVpcLAGinDgWcjIwMZWRkBOWFx44dq0ceeUSnTp0KDDutWLFCiYmJGjx4cKvnlJeXa8uWLRo5cqQkadWqVfL5fBozZkxQ6kL35HTY9I3LeurrI3po3cFi/WntIb2//7TW7PMfvVJjNX1ML31zZE+lxxOWAaCzC9ldVEePHlVpaanefPNNPf7441q7dq0kqX///oqPj5fX69Wll16q3NxcPfbYYyosLNRtt92mf//3f9ejjz4qSdq4caNuv/12rVy5Uj169JAk3XjjjSoqKtKiRYvU2NioO+64Q6NGjdJf/vKXdtfGXVRoj8PFNfrzx0f06uYCVdb712dy2AyNH5ylfxudp68MyJCdXh0ACJtOsZLxzJkztXjx4jMeX716ta699lpJ0pEjRzRr1iytWbNGcXFxmjFjhhYsWCCHw9+xtGbNGl133XU6dOiQ+vTpI8m/0N8999yjt956SzabTd/85jf15JNPKj4+vt21EXDQEbUNHr35yQm9vKlA2wvKA4/nJkXr65f10NdH9FT/zPb/+wMAnJ9OEXA6MwIOztfewkr9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nU5FRUV1uK3X61V9feu9HFFRUXI6nR1u6/P5VFfX+tBSR9o6HA65XC5J/gnQtbW1bbZNj3cpPd71pbYxZ23b1s+912eqrtGr2gb/Uecx5ZVdtY1e1TV4VVZVq9oGr+ob/WGortGnukav6ht9qvf41OjVF+e7G+X2+OT2+FTf1Mbt8an5p9tnqul7tP7zYxWb4V8t22G3+T/a/AHJYfOHILsh2Q3D/3nT81/+6IpyyG6zyW6TDNMMfD/bl9rZDH+odTmdgefk88mQTzbD+KK9Ychm879etMslu93/mM/nlXw+2W2GjKZ6bE3f12YYio52yWG3yWYY8nk98nm9gdc0DP97MAx/+5joaDnsdtlsktfjkdfjka3pueY2NsOQmtpGOewyDMnb6JHH0yib4a+h+aO/qaHYGP/vCJthyOtpVGNjY+B7/rNw/I6wEgEnBOLjW58ncNNNN+nvf/974OvMzMxWf4lec801WrNmTeDrPn36qLi4+KxtR40apU2bNgW+Hjx4sI4cOXLWtoMHD9auXbsCX48ePVq7d+8+a9vevXvr8OHDga+/+tWvavPmzWdtm56ertOnTwe+vvHGG/X++++ftW1sbGyLX/Lf/OY39fbbb5+1raQWAey2227T//7v/7batrq6OhCIvv/972vx4sWttj116pQyMjIkST/+8Y/19NNPt9r20KFD6tOnjyTpoYce0m9+85tW2+7cuVNDhgyRJD366KP65S9/2WrbjRs3avTo0ZKk3//+97r//vtbbbt69Wpde+21kqTnnntO99xzT6ttly1bpkmTJkmSXnrpJd1xxx2ttn311Vd1yy23SJKWLl2qf/3Xf2217QsvvKCZM2dKkt59911Nnjy51bZPPfWUZs+eLUlau3atrrvuulbbPvbYY5o7d64kaevWrbr88stbbfuLX/xC//Ef/yFJ2rNnjy655JJW2/7kJz/R448/Lkk6evSo8vPzW2179913a+HChZKk4uJiZWZmttp2xowZevHFFyX5/5PQ1s/9v/zLv+i1114LfN2R3xFxcXHt/h2RkZFx9t8RdocuG32F3nl3RVMA8mrc125UYXGJDIdLskfJsEfJcETJcDiV27OX5v30Z3J7fGrw+PTUM8+ouKzC38buaPoYJdkdiotP1FeuvU5uj08er0+f7tyt2nq3DLvD/31t9sDnNnuUnNHRavSe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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "H = qtx.operator.Ising(h=1.0)\n",
    "E, wf = H.diagonalize()\n",
    "exact_state = qtx.state.DenseState(wf)\n",
    "\n",
    "optimizer = qtx.optimizer.ER(state, H)\n",
    "\n",
    "energy = qtx.utils.DataTracer()\n",
    "training_rate = 0.02\n",
    "\n",
    "for i in range(100):\n",
    "    step = optimizer.get_step()\n",
    "    state.update(step * training_rate)\n",
    "    energy.append(optimizer.energy)\n",
    "\n",
    "energy.plot(baseline=E)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "abc51f2c",
   "metadata": {},
   "source": [
    "In small systems, we can transform `Variational` to `DenseState` to check its overlap with the exact ground state."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "fdcb03f7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Overlap with the exact ground state: 0.998887139941578\n"
     ]
    }
   ],
   "source": [
    "dense = state.todense().normalize()\n",
    "overlap = abs(dense @ exact_state)\n",
    "print(\"Overlap with the exact ground state:\", overlap)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d76a5dae",
   "metadata": {},
   "source": [
    "Now we have a nice neural quantum state for solving the Ising model!"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5eb3f108",
   "metadata": {},
   "source": [
    "## Avoid overflow\n",
    "\n",
    "In neural quantum state simulations, we often have very large wavefunctions beyond the range of float64. Here is an example."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "dbe7152c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Array(inf, dtype=float64)"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = MyModel(in_size=L, width=16)\n",
    "\n",
    "W1 = model.layer1.weight\n",
    "W2 = model.layer2.weight\n",
    "\n",
    "# Manually multiply weights by 100 to cause overflow\n",
    "model = eqx.tree_at(lambda model: model.layer1.weight, model, W1 * 100)\n",
    "model = eqx.tree_at(lambda model: model.layer2.weight, model, W2 * 100)\n",
    "\n",
    "s = qtx.utils.rand_states()\n",
    "model(s)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "27b63c60",
   "metadata": {},
   "source": [
    "To avoid this problem, we define two customized data types, `qtx.utils.LogArray` and `qtx.utils.ScaleArray`, to store large values. They are also accepted as network outputs in Quantax. Instead of using dangerous functions like `jnp.exp` that might cause overflow, one can use `qtx.nn.exp_by_scale` to output safe values expressed by `qtx.utils.ScaleArray`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "72d26ff7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ScaleArray(\n",
      "  significand=1.0,\n",
      "  exponent=15694.038701452486\n",
      ")\n"
     ]
    }
   ],
   "source": [
    "class NewModel(eqx.Module):\n",
    "    layer1: eqx.nn.Linear\n",
    "    layer2: eqx.nn.Linear\n",
    "\n",
    "    def __init__(self, in_size: int, width: int):\n",
    "        keys = qtx.get_subkeys(2)\n",
    "        layer1 = eqx.nn.Linear(in_size, width, key=keys[0])\n",
    "        self.layer1 = qtx.nn.apply_he_normal(keys[0], layer1)\n",
    "        layer2 = eqx.nn.Linear(width, width, key=keys[1])\n",
    "        self.layer2 = qtx.nn.apply_lecun_normal(keys[1], layer2)\n",
    "\n",
    "    def __call__(self, x):\n",
    "        x = jax.nn.relu(self.layer1(x))\n",
    "        x = self.layer2(x)\n",
    "        # Dangerous: psi = jnp.sum(jnp.exp(x))\n",
    "        # Safe:\n",
    "        psi = qtx.nn.exp_by_scale(x).sum()\n",
    "        return psi\n",
    "    \n",
    "\n",
    "model = NewModel(in_size=L, width=16)\n",
    "model = eqx.tree_at(lambda model: model.layer1.weight, model, W1 * 100)\n",
    "model = eqx.tree_at(lambda model: model.layer2.weight, model, W2 * 100)\n",
    "\n",
    "psi = model(s)\n",
    "print(psi)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d9ddaa0b",
   "metadata": {},
   "source": [
    "Here the output `ScaleArray` is a PyTree with significand $x$ and exponent $\\theta$. The true expressed value is $x e^\\theta$, which is beyond the range of float64. In most calculations, this quantity can be treated like an ordinary array object, as shown below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "8b4044be",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Reshape psi: ScaleArray(\n",
      "  significand=[[1. 1. 1. 1.]\n",
      " [1. 1. 1. 1.]],\n",
      "  exponent=15694.038701452486\n",
      ")\n",
      "Sum psi: ScaleArray(\n",
      "  significand=[4. 4.],\n",
      "  exponent=15694.038701452486\n",
      ")\n",
      "Power psi: ScaleArray(\n",
      "  significand=[1.00013864 1.00013864],\n",
      "  exponent=1.5694038701452486\n",
      ")\n",
      "To jax Array: [4.80444965 4.80444965]\n"
     ]
    }
   ],
   "source": [
    "psi = psi.repeat(8).reshape(2, 4)\n",
    "print(\"Reshape psi:\", psi)\n",
    "\n",
    "psi = psi.sum(axis=1)\n",
    "print(\"Sum psi:\", psi)\n",
    "\n",
    "psi = psi ** (1 / 10000)\n",
    "print(\"Power psi:\", psi)\n",
    "\n",
    "psi = jnp.asarray(psi)\n",
    "print(\"To jax Array:\", psi)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60552d11",
   "metadata": {},
   "source": [
    "However, JAX doesn't have a full support for [customized arrays](https://docs.jax.dev/en/latest/jep/28661-jax-array-protocol.html), so one should be careful when using these customized arrays. Here we list several possible problems.\n",
    "\n",
    "1. Manipulations like `jnp.fn(array)` transform customized arrays to `jax.Array`, causing overflow. To avoid it, call `array.fn()`.\n",
    "\n",
    "2. Computations like `jax_array * customized_array` always call `jax_array.__mul__(customized_array)`, which returns a `jax.Array` that might cause overflow. To avoid it, use `customized_array * jax_array`.\n",
    "\n",
    "Here are some examples"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "d2366af8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Wrong sum: nan\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Correct sum: ScaleArray(\n",
      "  significand=6.0,\n",
      "  exponent=10000.0\n",
      ")\n",
      "Wrong mul: [nan inf inf inf]\n",
      "Correct mul: ScaleArray(\n",
      "  significand=[0.         0.33333333 1.33333333 3.        ],\n",
      "  exponent=10001.098612288668\n",
      ")\n"
     ]
    }
   ],
   "source": [
    "significand = jnp.array([0.0, 1.0, 2.0, 3.0])\n",
    "exponent = jnp.array(10000.0)\n",
    "psi = qtx.utils.ScaleArray(significand, exponent)\n",
    "\n",
    "print(\"Wrong sum:\", jnp.sum(psi))\n",
    "print(\"Correct sum:\", psi.sum())\n",
    "\n",
    "a = jnp.arange(4)\n",
    "print(\"Wrong mul:\", a * psi)\n",
    "print(\"Correct mul:\", psi * a)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cd3a2e75",
   "metadata": {},
   "source": [
    "The new network with `ScaleArray` outputs also works with Quantax."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "0b20594b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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Df7rFrV5fWrzmB0//Vu7z5RPtsD+za3tavf61O411d7RzuMzA495fFK7z6d2j6k2j/dTj5unPSuu8/EWdf//GF11BiAjEIT836Odj3e2sdv8Q5OGIRkdj5263fG4YciQv63N5r/tfwWzo61xar+Oto6OIU//e5mS6W+rT7dVRziz22QzbDIM/79hmb5T7aQu9dntdtltNv8d05TP5+to01Fv5wEwTrWdPDxdN08YHLZj/1kEnBBITEzs9rmvfOUr+t///d/A/aysrG6/GK+66ipt2LAhcH/YsGGqrq4+bduJEydq69atgfujR4/WoUOHTtt29OjR2rNnT+D+pZdeqg8//PC0bYcOHapPPvkkcP+LX/yi3nvvvdO2zcjI0PHjxwP3r7/+er311lunbRsfH98lsN1888167bXXTttWUpcAduutt+pPf/pTt20bGhoCgei73/2uVqxY0W3bqqoqZWZmSpLuuusuPfHEE922LS0t1bBhwyRJ9913n/7jP/6j27a7d+/WmDFjJEk/+9nP9OCDD3bbdsuWLbr00kslSb/+9a91zz33dNv2zTff1Je+9CVJ0lNPPaXFixd323b16tWaMWOGJOn555/Xt771rW7bvvjii5ozZ44kadWqVfrqV7/abdtnn31W8+fPlyS98cYbmjlzZrdtH3vsMS1atEiStHHjRl199dXdtv35z3+uJUuWSJK2b9+uyy67rNu2P/7xj/WTn/xEkvTRRx/pwgsv7Lbtv/7rv+qRRx6RJB0+fFgFBQXdtv3e976nxx9/XJJUXV2trKysbtvOmzdPzz33nCT/Hwk9/b//x3/8R/3xj38M3E9KSuq27We/IxISEnr9HZGZmdnr74hhw4Z9/jvC5pBhd6ho9Bi9vekdeTqC0penX6+PSz+RDLsMu93fzmaXYbMrOzdPzzz3nNq9/vlPP7j3hyot/USy2WXYHZJhk2GzSza7EpOSdd/9D8jbEZxWrFipw0ePSbaONoZNhs0h2WxyxDg1d+435DX9bTdu3KSKyir/6xo2yWbzt++4fcWUK+X1mfKZpg58fFC1de6O17NJMvzvYfj3OW/wYJky5DOlOrdbLa1t/j90Ol7L385/32azqy/XUvGZki/wfTXgrsLShdNhI+AAACKAzyPT55HR3qyMRFfgYVtjtdqrD59+H6NO1xRlB+7+uHK3Gj88/R9B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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "model = NewModel(in_size=L, width=16)\n",
    "state = qtx.state.Variational(model)\n",
    "optimizer = qtx.optimizer.ER(state, H)\n",
    "\n",
    "energy = qtx.utils.DataTracer()\n",
    "training_rate = 0.02\n",
    "\n",
    "for i in range(100):\n",
    "    step = optimizer.get_step()\n",
    "    state.update(step * training_rate)\n",
    "    energy.append(optimizer.energy)\n",
    "\n",
    "energy.plot(baseline=E)\n",
    "plt.show()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "quantax_env",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
