<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>utils &#8212; Quantax 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=2bf1fcf8" />
    
    <script src="../_static/documentation_options.js?v=01f34227"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="canonical" href="https://chenao-phys.github.io/quantax/utils/utils.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="quantax.utils.DataTracer" href="quantax.utils.DataTracer.html" />
    <link rel="prev" title="quantax.optimizer.minsr_pinv_eig" href="../optimizer/quantax.optimizer.minsr_pinv_eig.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="quantax.utils.DataTracer.html" title="quantax.utils.DataTracer"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../optimizer/quantax.optimizer.minsr_pinv_eig.html" title="quantax.optimizer.minsr_pinv_eig"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Quantax 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">utils</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="utils">
<h1>utils<a class="headerlink" href="#utils" title="Link to this heading">¶</a></h1>
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.DataTracer.html#quantax.utils.DataTracer" title="quantax.utils.DataTracer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataTracer</span></code></a></p></td>
<td><p>The structure used to keep track of the data updates</p></td>
</tr>
</tbody>
</table>
</section>
<section id="sharding">
<h2>Sharding<a class="headerlink" href="#sharding" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.get_global_sharding.html#quantax.utils.get_global_sharding" title="quantax.utils.get_global_sharding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_global_sharding</span></code></a></p></td>
<td><p>Return the sharding that distributes arrays across all devices in <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.devices()</span></code> in the array's first dimension.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.get_replicate_sharding.html#quantax.utils.get_replicate_sharding" title="quantax.utils.get_replicate_sharding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_replicate_sharding</span></code></a></p></td>
<td><p>Return the sharding that replicates arrays across all devices in <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.devices()</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="array">
<h2>Array<a class="headerlink" href="#array" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.is_sharded_array.html#quantax.utils.is_sharded_array" title="quantax.utils.is_sharded_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_sharded_array</span></code></a></p></td>
<td><p>Whether the input array is sharded.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.to_global_array.html#quantax.utils.to_global_array" title="quantax.utils.to_global_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_global_array</span></code></a></p></td>
<td><p>Transform the array to be sharded across all devices in the first dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.to_replicate_array.html#quantax.utils.to_replicate_array" title="quantax.utils.to_replicate_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_replicate_array</span></code></a></p></td>
<td><p>Transform the array to be replicated across all devices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.global_to_local.html#quantax.utils.global_to_local" title="quantax.utils.global_to_local"><code class="xref py py-obj docutils literal notranslate"><span class="pre">global_to_local</span></code></a></p></td>
<td><p>In multi-host jobs, use <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.experimental.multihost_utils.global_array_to_host_local_array</span></code> to transform a sharded array to be local on each device.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.local_to_global.html#quantax.utils.local_to_global" title="quantax.utils.local_to_global"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_to_global</span></code></a></p></td>
<td><p>In multi-host jobs, use <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.experimental.multihost_utils.host_local_array_to_global_array</span></code> to transform local arrays to be sharded.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.local_to_replicate.html#quantax.utils.local_to_replicate" title="quantax.utils.local_to_replicate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_to_replicate</span></code></a></p></td>
<td><p>In multi-host jobs, use <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.experimental.multihost_utils.host_local_array_to_global_array</span></code> to transform local arrays to be replicated on each device.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.to_replicate_numpy.html#quantax.utils.to_replicate_numpy" title="quantax.utils.to_replicate_numpy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_replicate_numpy</span></code></a></p></td>
<td><p>In multi-host jobs, use <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.experimental.multihost_utils.global_array_to_host_local_array</span></code> to transform a sharded array to be replicated numpy arrays on each device.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.array_extend.html#quantax.utils.array_extend" title="quantax.utils.array_extend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_extend</span></code></a></p></td>
<td><p>Extend the array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.array_set.html#quantax.utils.array_set" title="quantax.utils.array_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_set</span></code></a></p></td>
<td><p>Equivalent to <code class="xref py py-obj docutils literal notranslate"><span class="pre">array.at[inds].set(array_set)</span></code>, but significantly faster for complex-valued inputs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.sharded_segment_sum.html#quantax.utils.sharded_segment_sum" title="quantax.utils.sharded_segment_sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sharded_segment_sum</span></code></a></p></td>
<td><p>Equivalent to <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.ops.segment_sum</span></code>, but avoid data transfer among devices when <code class="xref py py-obj docutils literal notranslate"><span class="pre">data</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">segment_ids</span></code> are both properly sharded.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="spins">
<h2>Spins<a class="headerlink" href="#spins" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.ints_to_array.html#quantax.utils.ints_to_array" title="quantax.utils.ints_to_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ints_to_array</span></code></a></p></td>
<td><p>Converts QuSpin basis integers to int8 state array</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.array_to_ints.html#quantax.utils.array_to_ints" title="quantax.utils.array_to_ints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_to_ints</span></code></a></p></td>
<td><p>Converts int8 state array to QuSpin basis integers</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.neel.html#quantax.utils.neel" title="quantax.utils.neel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">neel</span></code></a></p></td>
<td><p>Return a single neel state</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.stripe.html#quantax.utils.stripe" title="quantax.utils.stripe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stripe</span></code></a></p></td>
<td><p>Return a single stripe state</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.Sqz_factor.html#quantax.utils.Sqz_factor" title="quantax.utils.Sqz_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sqz_factor</span></code></a></p></td>
<td><p>Spin structure factor <span class="math notranslate nohighlight">\(\left&lt; \frac{1}{2 \sqrt{N}} S^z_r S^z_0 e^{-iqr} \right&gt;\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.rand_states.html#quantax.utils.rand_states" title="quantax.utils.rand_states"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rand_states</span></code></a></p></td>
<td><p>Random basis states.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pytree">
<h2>Pytree<a class="headerlink" href="#pytree" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.tree_fully_flatten.html#quantax.utils.tree_fully_flatten" title="quantax.utils.tree_fully_flatten"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tree_fully_flatten</span></code></a></p></td>
<td><p>Return the array given by <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.flatten_util.ravel_pytree</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.filter_replicate.html#quantax.utils.filter_replicate" title="quantax.utils.filter_replicate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_replicate</span></code></a></p></td>
<td><p>Transform the pytree to be replicated on all devices.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.filter_tree_map.html#quantax.utils.filter_tree_map" title="quantax.utils.filter_tree_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_tree_map</span></code></a></p></td>
<td><p>The same as <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.tree.map</span></code> but with filter, which means the map only applies to arrays.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.tree_split_cpl.html#quantax.utils.tree_split_cpl" title="quantax.utils.tree_split_cpl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tree_split_cpl</span></code></a></p></td>
<td><p>Split a pytree potentially with complex values to two real pytrees, one for the real part and the other for the imaginary part</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.tree_combine_cpl.html#quantax.utils.tree_combine_cpl" title="quantax.utils.tree_combine_cpl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tree_combine_cpl</span></code></a></p></td>
<td><p>Combine two real pytrees to a complex one.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.apply_updates.html#quantax.utils.apply_updates" title="quantax.utils.apply_updates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_updates</span></code></a></p></td>
<td><p>Similar to <code class="xref py py-obj docutils literal notranslate"><span class="pre">equinox.apply_updates</span></code>, but the original data type of the model is kept unchanged.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="function">
<h2>Function<a class="headerlink" href="#function" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.chunk_shard_vmap.html#quantax.utils.chunk_shard_vmap" title="quantax.utils.chunk_shard_vmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chunk_shard_vmap</span></code></a></p></td>
<td><p>f -&gt; jit(chunk_map(shard_map(vmap(f))))</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.chunk_map.html#quantax.utils.chunk_map" title="quantax.utils.chunk_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chunk_map</span></code></a></p></td>
<td><p>Convert a vmapped function to a function with chunked batches and parallel computation on all available machines.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.shmap.html#quantax.utils.shmap" title="quantax.utils.shmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shmap</span></code></a></p></td>
<td><p>f -&gt; shard_map(f), sharded along the first dimension</p></td>
</tr>
</tbody>
</table>
</section>
<section id="linear-algebra">
<h2>Linear algebra<a class="headerlink" href="#linear-algebra" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.det.html#quantax.utils.det" title="quantax.utils.det"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det</span></code></a></p></td>
<td><p>The same as <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.numpy.linalg.det</span></code>, but with a customized vjp to accelerate gradients</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.pfaffian.html#quantax.utils.pfaffian" title="quantax.utils.pfaffian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfaffian</span></code></a></p></td>
<td><p>Return pfaffian of the input matrix A.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.det_update_rows.html#quantax.utils.det_update_rows" title="quantax.utils.det_update_rows"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det_update_rows</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.det_update_gen.html#quantax.utils.det_update_gen" title="quantax.utils.det_update_gen"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det_update_gen</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="quantax.utils.pfa_eye.html#quantax.utils.pfa_eye" title="quantax.utils.pfa_eye"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfa_eye</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="quantax.utils.pfa_update.html#quantax.utils.pfa_update" title="quantax.utils.pfa_update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pfa_update</span></code></a></p></td>
<td><p>Applies a low-rank update to a pfaffian matrix, returning the ratio between the updated pfaffian and the old pfaffian as well as the inverse of the update orbitals</p></td>
</tr>
</tbody>
</table>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">utils</a><ul>
<li><a class="reference internal" href="#data">Data</a></li>
<li><a class="reference internal" href="#sharding">Sharding</a></li>
<li><a class="reference internal" href="#array">Array</a></li>
<li><a class="reference internal" href="#spins">Spins</a></li>
<li><a class="reference internal" href="#pytree">Pytree</a></li>
<li><a class="reference internal" href="#function">Function</a></li>
<li><a class="reference internal" href="#linear-algebra">Linear algebra</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../optimizer/quantax.optimizer.minsr_pinv_eig.html"
                          title="previous chapter">quantax.optimizer.minsr_pinv_eig</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="quantax.utils.DataTracer.html"
                          title="next chapter">quantax.utils.DataTracer</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/utils/utils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="quantax.utils.DataTracer.html" title="quantax.utils.DataTracer"
             >next</a> |</li>
        <li class="right" >
          <a href="../optimizer/quantax.optimizer.minsr_pinv_eig.html" title="quantax.optimizer.minsr_pinv_eig"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Quantax 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">utils</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Ao Chen.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>