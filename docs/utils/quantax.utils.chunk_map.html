<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>quantax.utils.chunk_map &#8212; Quantax 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=01f34227"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="canonical" href="https://chenao-phys.github.io/quantax/utils/quantax.utils.chunk_map.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="quantax.utils.shmap" href="quantax.utils.shmap.html" />
    <link rel="prev" title="quantax.utils.chunk_shard_vmap" href="quantax.utils.chunk_shard_vmap.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="quantax-utils-chunk-map">
<h1>quantax.utils.chunk_map<a class="headerlink" href="#quantax-utils-chunk-map" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="quantax.utils.chunk_map">
<span class="sig-prename descclassname"><span class="pre">quantax.utils.</span></span><span class="sig-name descname"><span class="pre">chunk_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_scan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="headerlink" href="#quantax.utils.chunk_map" title="Link to this definition">¶</a></dt>
<dd><p>Convert a vmapped function to a function with chunked batches and parallel
computation on all available machines. The arguments will be unchanged if the batch
size on each machine is smaller than the chunk size, but it will be padded with 0
if the batch size is larger than the chunk size and not a multiple of chunk size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – The function to be converted. The arguments of f are assumed to be sharded.</p></li>
<li><p><strong>in_axes</strong> – The vmapped axes of f which are to be chunked.</p></li>
<li><p><strong>out_axes</strong> – The vmapped axes of outputs.</p></li>
<li><p><strong>chunk_size</strong> – The chunk size on each machine.</p></li>
<li><p><strong>use_scan</strong> – Whether to use <code class="xref py py-obj docutils literal notranslate"><span class="pre">jax.lax.scan</span></code> in chunked function apply. The compilation will be
accerlerated if <code class="xref py py-obj docutils literal notranslate"><span class="pre">scan</span></code> is used, but the function must be jittable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Quantax</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../global_defs.html">global_defs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sites/sites.html">sites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../symmetry/symmetry.html">symmetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../operator/operator.html">operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nn/nn.html">nn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../model/model.html">model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../state/state.html">state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sampler/sampler.html">sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimizer/optimizer.html">optimizer</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="utils.html">utils</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api.html">API</a><ul>
  <li><a href="utils.html">utils</a><ul>
      <li>Previous: <a href="quantax.utils.chunk_shard_vmap.html" title="previous chapter">quantax.utils.chunk_shard_vmap</a></li>
      <li>Next: <a href="quantax.utils.shmap.html" title="next chapter">quantax.utils.shmap</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Ao Chen.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/utils/quantax.utils.chunk_map.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>